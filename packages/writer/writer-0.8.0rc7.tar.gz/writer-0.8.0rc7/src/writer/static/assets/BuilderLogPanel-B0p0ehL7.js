import{B as A}from"./BuilderPanel-BYbTfrap.js";import{d as D,i as b,a as w,r as F,c as V,o as t,e as n,F as k,s as N,f as e,q as _,t as r,m as P,n as f,W as T,x as S,b as u,M as x,J as m,P as E,y as M,z as R,N as K,_ as W}from"./index-CFkyh9F6.js";import{B as q,a as G}from"./BuilderApp-CepsW_mm.js";const i=a=>(M("data-v-f0a35510"),a=a(),R(),a),J={class:"BuilderLogWorkflowExecution"},H=i(()=>e("div",{class:"marker top"},null,-1)),O=i(()=>e("div",{class:"marker bottom"},null,-1)),Q={class:"item"},U={class:"name"},X=i(()=>e("i",{class:"material-symbols-outlined"},"jump_to_element",-1)),Y={class:"outcome"},Z={class:"result"},ee={class:"detailsModalContent"},te=i(()=>e("h2",null,"Result",-1)),oe=i(()=>e("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),se={class:"data"},ne={key:1,class:"nothing"},ae=i(()=>e("h2",null,"Execution environment",-1)),le=i(()=>e("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),ie={class:"data"},ce={key:1,class:"nothing"},de=i(()=>e("h2",null,"Return value",-1)),re=i(()=>e("p",null," The value being returned, which is used to determine the result of 'Run workflow' blocks and 'Chat completion' tool calls. ",-1)),ue={class:"data"},_e=i(()=>e("i",{class:"material-symbols-outlined"},"find_in_page",-1)),me={class:"time"},he=D({__name:"BuilderLogWorkflowExecution",props:{executionLog:{}},setup(a){const c=b(w.core),h=b(w.builderManager),{goToComponentParentPage:v}=K(c,h),C=a,l=F(null),s=V(()=>({summary:[...C.executionLog.summary.map(p=>({...p,component:c.getComponentById(p.componentId),componentDef:c.getComponentById(p.componentId)?c.getComponentDefinition(c.getComponentById(p.componentId).type):void 0}))]}));async function y(d){h.setMode("workflows"),await E(),v(d),await E(),h.setSelection(d,void 0,"log")}function z(d){return d<0?"N/A":d<.1?"< 0.1s":`${d.toFixed(2)}s`}return(d,p)=>(t(),n("div",J,[(t(!0),n(k,null,N(s.value.summary,(o,j)=>{var B,L;return t(),n("div",{key:j,class:"row"},[H,O,e("div",Q,[e("div",U,[_(r(o.componentDef.name)+" ",1),P(T,{variant:"neutral",size:"unpadded",title:"Go to node",onClick:g=>y(o.componentId)},{default:f(()=>[X]),_:2},1032,["onClick"])]),e("div",Y,[e("div",{class:S(["ball",(B=o.componentDef.outs[o.outcome])==null?void 0:B.style])},null,2),_(" "+r(((L=o.componentDef.outs[o.outcome])==null?void 0:L.name)??o.outcome),1)]),e("div",Z,[l.value!==null?(t(),u(q,{key:0,"close-action":{desc:"Close",fn:()=>l.value=null},icon:"find_in_page","modal-title":"Details"},{default:f(()=>{var g,$,I;return[e("div",ee,[e("div",null,[te,oe,e("div",se,[(g=l.value)!=null&&g.result?(t(),u(x,{key:0,data:l.value.result,"initial-depth":1,class:"data"},null,8,["data"])):(t(),n("div",ne,"No result."))])]),e("div",null,[ae,le,e("div",ie,[($=l.value)!=null&&$.executionEnvironment?(t(),u(x,{key:0,data:l.value.executionEnvironment,"initial-depth":1,class:"data"},null,8,["data"])):(t(),n("div",ce," Empty execution environment. "))])]),e("div",null,[de,re,e("div",ue,[(I=l.value)!=null&&I.returnValue?(t(),u(x,{key:0,data:l.value.returnValue,"initial-depth":1,class:"data"},null,8,["data"])):(t(),n(k,{key:1},[_(" No return value. ")],64))])])])]}),_:1},8,["close-action"])):m("",!0),o.result||o.returnValue||o.executionEnvironment?(t(),u(T,{key:1,variant:"secondary",size:"small",onClick:()=>l.value={executionEnvironment:o.executionEnvironment,result:o.result,returnValue:o.returnValue}},{default:f(()=>[_e,_(" Details ")]),_:2},1032,["onClick"])):m("",!0)]),e("div",me,r(z(o.executionTimeInSeconds)),1)])])}),128))]))}}),ve=W(he,[["__scopeId","data-v-f0a35510"]]),pe=a=>(M("data-v-c3ff338e"),a=a(),R(),a),fe={key:0,class:"entries"},ke={class:"icon"},ye={key:0,class:"material-symbols-outlined"},ge={key:1,class:"material-symbols-outlined"},xe={class:"title"},be={class:"time"},we={class:"content"},Ce={key:0,class:"codeContainer"},Be={key:1,class:"emptyMessage"},Le=pe(()=>e("div",null,[_(" Exceptions and other relevant messages will be shown here."),e("br"),_("Also, you can include print statements in event handlers to create log entries. ")],-1)),$e=[Le],Ie=D({__name:"BuilderLogPanel",setup(a){const c=b(w.builderManager),h=[{icon:"delete",name:"Clear log",callback:()=>{c.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}},{icon:"close",name:"Close",callback:()=>{c.openPanels.delete("log")},keyboardShortcut:{modifierKey:!1,key:"Escape"}}],v=V(()=>c.getLogEntries());return(C,l)=>(t(),u(A,{name:"Log",actions:h,tabindex:"0",class:"BuilderLogPanel"},{titleCompanion:f(()=>[P(G)]),default:f(()=>[v.value.length>0?(t(),n("div",fe,[(t(!0),n(k,null,N(v.value,(s,y)=>(t(),n(k,{key:y},[e("div",{class:S(["entry",s.type])},[e("div",ke,[s.type=="error"?(t(),n("i",ye,"error")):(t(),n("i",ge,"info"))]),e("div",xe,r(s.title)+r(s.repeated>0?` Â· Repeated ${s.repeated} times`:""),1),e("div",be,r(s.timestampReceived.toLocaleTimeString()),1),e("div",we,[_(r(s.message)+" ",1),s.code?(t(),n("div",Ce,[e("code",null,r(s.code),1)])):m("",!0)])],2),s.workflowExecution?(t(),u(ve,{key:0,"execution-log":s.workflowExecution},null,8,["execution-log"])):m("",!0)],64))),128))])):m("",!0),v.value.length==0?(t(),n("div",Be,$e)):m("",!0)]),_:1}))}}),Ve=W(Ie,[["__scopeId","data-v-c3ff338e"]]);export{Ve as default};
