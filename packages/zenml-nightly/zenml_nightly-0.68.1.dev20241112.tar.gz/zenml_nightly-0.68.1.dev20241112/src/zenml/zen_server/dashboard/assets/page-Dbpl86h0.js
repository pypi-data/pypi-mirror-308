import{r as l,j as e}from"./@radix-DP6vWzyx.js";import{l as D,m as R,k as G,n as H,F as k,i as V,o as K,p as Q,f as x,D as J,q as W,s as X,C as Y,t as ee,r as d,T as _,v as A,w as E,x as L,y as N,E as w,z as o,G as F,S as j,B as se,H as te,J as ae,K as ne,e as re,L as v,M as ie,N as le,P as oe}from"./index-QQb7wQEC.js";import{L as m,c as b,b as ce}from"./@react-router-BMhZulnd.js";import{S as M}from"./refresh-BVu22P_C.js";import{S as B,P as O}from"./SearchField-DfUiGFVd.js";import{q as de,b as me,c as pe,a as ue}from"./@tanstack-BUCbhJyH.js";import{o as he}from"./url-D5le3J4q.js";import{S as z}from"./trash-DkJHMOg7.js";import{D as I,a as Z,g as $,E as U,b as xe}from"./delete-run-D-LKbGyz.js";import{C as g}from"./CopyButton-C745BrKi.js";import{S as fe}from"./dots-horizontal-DK5Duzx4.js";import{A as je}from"./AlertDialogDropdownItem-C6N2rGrB.js";import{R as ge,a as be,u as Ce,b as ve,c as ye,d as Pe}from"./RunSelector-DCiL3M1c.js";import{D as Ne}from"./DisplayDate-BeXgUG_C.js";import{I as we}from"./InlineAvatar-jEgodSgX.js";import{I as Se}from"./Infobox-BwisKifi.js";import"./@reactflow-8U9qNlMR.js";import"./chevron-right-double-DoD8iXWM.js";import"./index-BVJ8n2-j.js";import"./zod-D89GC_vc.js";import"./index.esm-cuVep_NJ.js";import"./check-circle-Dwxliy1Z.js";import"./copy-CaSMXwiU.js";const Te=s=>l.createElement("svg",{viewBox:"0 0 60 60",fill:"black",xmlns:"http://www.w3.org/2000/svg",...s},l.createElement("g",{id:"dataflow-02"},l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 7.5C11.1193 7.5 10 8.61929 10 10C10 11.3807 11.1193 12.5 12.5 12.5C13.8807 12.5 15 11.3807 15 10C15 8.61929 13.8807 7.5 12.5 7.5ZM5 10C5 5.85786 8.35787 2.5 12.5 2.5C15.7655 2.5 18.5436 4.58702 19.5732 7.5L40.4268 7.5C41.4564 4.58702 44.2345 2.5 47.5 2.5C51.6421 2.5 55 5.85786 55 10C55 14.1421 51.6421 17.5 47.5 17.5C44.2345 17.5 41.4564 15.413 40.4268 12.5L32.5 12.5V27.5H40.4268C41.4564 24.587 44.2345 22.5 47.5 22.5C51.6421 22.5 55 25.8579 55 30C55 34.1421 51.6421 37.5 47.5 37.5C44.2345 37.5 41.4564 35.413 40.4268 32.5H32.5V38C32.5 40.1415 32.502 41.5972 32.5939 42.7224C32.6834 43.8185 32.8457 44.379 33.045 44.77C33.5243 45.7108 34.2892 46.4757 35.2301 46.955C35.6211 47.1543 36.1816 47.3166 37.2776 47.4061C38.103 47.4736 39.1062 47.4926 40.4275 47.4979C41.4577 44.586 44.2352 42.5 47.5 42.5C51.6421 42.5 55 45.8579 55 50C55 54.1421 51.6421 57.5 47.5 57.5C44.2338 57.5 41.4552 55.4121 40.4261 52.4982C39.0579 52.4929 37.8787 52.4719 36.8704 52.3895C35.4652 52.2747 34.1734 52.0283 32.9601 51.4101C31.0785 50.4513 29.5487 48.9215 28.5899 47.0399C27.9717 45.8266 27.7253 44.5348 27.6105 43.1296C27.4999 41.7766 27.5 40.1157 27.5 38.1032V12.5L19.5732 12.5C18.5436 15.413 15.7655 17.5 12.5 17.5C8.35787 17.5 5 14.1421 5 10ZM47.5 7.5C46.1193 7.5 45 8.61929 45 10C45 11.3807 46.1193 12.5 47.5 12.5C48.8807 12.5 50 11.3807 50 10C50 8.61929 48.8807 7.5 47.5 7.5ZM47.5 27.5C46.1193 27.5 45 28.6193 45 30C45 31.3807 46.1193 32.5 47.5 32.5C48.8807 32.5 50 31.3807 50 30C50 28.6193 48.8807 27.5 47.5 27.5ZM47.5 47.5C46.1193 47.5 45 48.6193 45 50C45 51.3807 46.1193 52.5 47.5 52.5C48.8807 52.5 50 51.3807 50 50C50 48.6193 48.8807 47.5 47.5 47.5Z"})));async function De({params:s}){const t=D(R.pipelines.all+"?"+he(s)),a=await G(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(a.status===404&&H(),!a.ok)throw new k({message:"Error while fetching pipelines",status:a.status,statusText:a.statusText});return a.json()}const S={all:["pipelines"],pipelineList:s=>de({queryKey:[...S.all,s],queryFn:async()=>De({params:s})})};async function Re({pipelineId:s}){const t=D(R.pipelines.detail(s)),a=await fetch(t,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"}});if(!a.ok){const n=await a.json().then(r=>r.detail).catch(()=>`Failed to delete pipeline ${s}`);throw new k({status:a.status,statusText:a.statusText,message:n})}return a.json()}function ke(s){return me({mutationFn:Re,...s})}const q=l.createContext(null);function _e({children:s}){const[t,a]=l.useState([]),n=pe(),{toast:r}=V(),i=ke(),c=async p=>{try{const u=p.map(C=>i.mutateAsync({pipelineId:C}));await Promise.all(u),r({description:"Deleted successfully.",status:"success",emphasis:"subtle",rounded:!0}),await n.invalidateQueries({queryKey:S.all}),a([])}catch(u){console.error("Failed to delete some pipelines:",u)}};return e.jsx(q.Provider,{value:{selectedPipelines:t,setSelectedPipelines:a,bulkDeletePipelines:c},children:s})}function f(){const s=l.useContext(q);if(!s)throw new Error("usePipelinesSelectorContext must be used within a PipelinesSelectorProvider");return s}function Ae(){const[s,t]=l.useState(!1),{bulkDeletePipelines:a,selectedPipelines:n}=f();async function r(){await a(n),t(!1)}return e.jsxs(K,{open:s,onOpenChange:t,children:[e.jsx(Q,{children:e.jsxs(x,{className:"rounded-sharp border-none bg-white",size:"md",emphasis:"subtle",intent:"secondary",children:[e.jsx(z,{className:"h-5 w-5 shrink-0 gap-1 fill-neutral-400"}),"Delete"]})}),e.jsx(I,{title:`Delete Pipeline${n.length>=2?"s":""}`,handleDelete:r,children:e.jsxs(Z,{children:[e.jsx("p",{children:"Are you sure?"}),e.jsx("p",{children:"This action cannot be undone."})]})})]})}function Ee(){const{selectedPipelines:s}=f();return e.jsxs("div",{className:"flex items-center divide-x divide-theme-border-moderate overflow-hidden rounded-md border border-theme-border-moderate",children:[e.jsx("div",{className:"bg-primary-25 px-2 py-1 font-semibold text-theme-text-brand",children:`${s==null?void 0:s.length} Pipeline${(s==null?void 0:s.length)>1?"s":""} selected`}),e.jsx(Ae,{})]})}function Le({id:s}){const[t,a]=l.useState(!1),[n,r]=l.useState(!1),i=l.useRef(null),c=l.useRef(null),{bulkDeletePipelines:p}=f();async function u(){await p([s]),T(!1)}function C(){c.current=i.current}function T(h){if(h===!1){r(!1),setTimeout(()=>{a(h)},200);return}a(h)}return e.jsxs(J,{onOpenChange:r,open:n,children:[e.jsx(W,{ref:i,children:e.jsx(fe,{className:"h-4 w-4 fill-theme-text-tertiary"})}),e.jsx(X,{hidden:t,onCloseAutoFocus:h=>{c.current&&(c.current.focus(),c.current=null,h.preventDefault())},align:"end",sideOffset:7,children:e.jsx(je,{onSelect:C,open:t,onOpenChange:T,triggerChildren:"Delete",icon:e.jsx(z,{fill:"red"}),children:e.jsx(I,{title:"Delete Pipeline",handleDelete:u,children:e.jsxs(Z,{children:[e.jsx("p",{children:"Are you sure?"}),e.jsx("p",{children:"This action cannot be undone."})]})})})})]})}const Fe=({id:s})=>{const{selectedPipelines:t,setSelectedPipelines:a}=f(),n=(r,i)=>{a(c=>r?[...c,i]:c.filter(p=>p!==i))};return e.jsx(Y,{id:s,onCheckedChange:r=>n(r,s),checked:t.includes(s),className:"h-3 w-3"})};function Me(){return[{id:"check",header:"",meta:{width:"1%"},cell:({row:s})=>e.jsx(Fe,{id:s.original.id})},{id:"name",header:"Pipeline",cell:({row:s})=>{var t,a,n;return e.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[e.jsx(ee,{className:`h-5 w-5 ${$((t=s.original.body)==null?void 0:t.latest_run_status)}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{to:d.pipelines.namespace(encodeURIComponent(s.original.name)),className:"flex items-center gap-1",children:e.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:s.original.name})}),e.jsx(_,{children:e.jsxs(A,{children:[e.jsx(E,{className:"hover:text-theme-text-brand hover:underline",children:e.jsx(U,{status:(a=s.original.body)==null?void 0:a.latest_run_status})}),e.jsx(L,{className:"z-20 capitalize",children:(n=s.original.body)==null?void 0:n.latest_run_status})]})}),e.jsx(g,{copyText:s.original.name})]}),e.jsxs(m,{to:d.pipelines.namespace(encodeURIComponent(s.original.name)),className:"flex items-center gap-1",children:[e.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:s.original.id.split("-")[0]}),e.jsx(g,{copyText:s.original.id})]})]})]})}},{id:"latest-run",header:"Latest Run",accessorFn:s=>{var t,a;return{status:(t=s.body)==null?void 0:t.latest_run_status,runId:(a=s.body)==null?void 0:a.latest_run_id}},cell:({getValue:s})=>{const{runId:t,status:a}=s();return!t||!a?e.jsx("div",{children:"No run"}):e.jsx(m,{to:d.runs.detail(t),children:e.jsxs(N,{emphasis:"subtle",rounded:!1,className:"inline-flex items-center gap-0.5",color:xe(a),children:[e.jsx(w,{className:"h-3 w-3 fill-current"}),t==null?void 0:t.split("-")[0]]})})}},{id:"admin_actions",header:"",meta:{width:"5%"},cell:({row:s})=>e.jsx(Le,{id:s.original.id})}]}const y=1,Be=o.object({page:o.coerce.number().min(y).optional().default(y).catch(y),name:o.string().optional(),operator:o.enum(["and","or"]).optional()});function Oe(){const[s]=b(),{page:t,name:a,operator:n}=Be.parse({page:s.get("page")||void 0,name:s.get("name")||void 0,operator:s.get("operator")||void 0});return{page:t,name:a,logical_operator:n}}function ze(){const s=Oe(),{selectedPipelines:t}=f(),{data:a,refetch:n}=ue({...S.pipelineList({...s,sort_by:"desc:latest_run"}),throwOnError:!0});return e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[t.length?e.jsx(Ee,{}):e.jsx(B,{searchParams:s}),e.jsx("div",{className:"flex justify-between",children:e.jsxs(x,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>n(),children:[e.jsx(M,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})})]}),e.jsxs("div",{className:"flex flex-col items-center gap-5",children:[e.jsx("div",{className:"w-full",children:a?e.jsx(F,{columns:Me(),data:a.items}):e.jsx(j,{className:"h-[500px] w-full"})}),a?a.total_pages>1&&e.jsx(O,{searchParams:s,paginate:a}):e.jsx(j,{className:"h-[36px] w-[300px]"})]})]})}const Ie=[{id:"check",header:"",meta:{width:"1%"},accessorFn:s=>({id:s.id}),cell:({getValue:s})=>{const{id:t}=s();return e.jsx(ge,{id:t})}},{id:"name",header:"Run",accessorFn:s=>{var t;return{id:s.id,name:s.name,status:(t=s.body)==null?void 0:t.status}},cell:({getValue:s})=>{const{name:t,status:a,id:n}=s();return e.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[e.jsx(w,{className:`h-5 w-5 ${$(a)}`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{to:d.runs.detail(n),className:"flex items-center gap-1",children:e.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:t})}),e.jsx(_,{children:e.jsxs(A,{children:[e.jsx(E,{className:"hover:text-theme-text-brand hover:underline",children:e.jsx(U,{status:a})}),e.jsx(L,{className:"z-20 capitalize",children:a})]})}),e.jsx(g,{copyText:t})]}),e.jsxs(m,{to:d.runs.detail(n),className:"flex items-center gap-1",children:[e.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:n.split("-")[0]}),e.jsx(g,{copyText:n})]})]})]})}},{id:"pipeline",header:"Pipeline",accessorFn:s=>{var t,a;return(a=(t=s.body)==null?void 0:t.pipeline)==null?void 0:a.name},cell:({getValue:s})=>{const t=s();return t?e.jsx(m,{to:d.pipelines.namespace(t),children:e.jsx(N,{color:"purple",className:"inline-flex items-center gap-0.5 truncate",rounded:!1,emphasis:"subtle",children:t})}):null}},{id:"stack",header:"Stack",accessorFn:s=>{var t,a,n,r;return{name:(a=(t=s.body)==null?void 0:t.stack)==null?void 0:a.name,id:(r=(n=s.body)==null?void 0:n.stack)==null?void 0:r.id}},cell:({getValue:s})=>{const{name:t,id:a}=s();return!t||!a?null:e.jsx(N,{rounded:!1,className:"inline-block",color:"turquoise",emphasis:"subtle",children:t})}},{id:"created-at",header:"Created at",accessorFn:s=>{var t;return{date:(t=s.body)==null?void 0:t.created}},cell:({getValue:s})=>{const{date:t}=s();return e.jsx(Ne,{dateString:t})}},{id:"author",header:"Author",accessorFn:s=>{var t,a,n,r,i;return{name:((n=(a=(t=s.body)==null?void 0:t.user)==null?void 0:a.body)==null?void 0:n.full_name)||((i=(r=s.body)==null?void 0:r.user)==null?void 0:i.name)}},cell:({getValue:s})=>{const{name:t}=s();return e.jsx(we,{username:t})}},{id:"admin_actions",header:"",meta:{width:"5%"},cell:({row:s})=>e.jsx(be,{id:s.original.id})}],P=1,Ze=o.object({page:o.coerce.number().min(P).optional().default(P).catch(P),name:o.string().optional(),operator:o.enum(["and","or"]).optional(),status:o.enum(["pending","running","completed"]).optional()});function $e(){const[s]=b(),{page:t,name:a,operator:n,status:r}=Ze.parse({page:s.get("page")||void 0,name:s.get("name")||void 0,operator:s.get("operator")||void 0,status:s.get("status")||void 0});return{page:t,name:a,logical_operator:n,status:r}}function Ue(){const{selectedRuns:s}=Ce(),t=$e(),{data:a,refetch:n}=ve({params:{...t,sort_by:"desc:updated"}});return e.jsxs("div",{className:"mt-5 flex flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[s.length?e.jsx(ye,{}):e.jsx(B,{searchParams:t}),e.jsx("div",{className:"flex justify-between",children:e.jsxs(x,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>n(),children:[e.jsx(M,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})})]}),e.jsxs("div",{className:"flex flex-col items-center gap-5",children:[e.jsx("div",{className:"w-full",children:a?e.jsx(F,{columns:Ie,data:a.items}):e.jsx(j,{className:"h-[500px] w-full"})}),a?a.total_pages>1&&e.jsx(O,{searchParams:t,paginate:a}):e.jsx(j,{className:"h-[36px] w-[300px]"})]})]})}const qe=o.object({tab:o.enum(["pipelines","runs","templates"]).optional().default("pipelines").catch("pipelines")});function Ge(){const[s]=b(),{tab:t}=qe.parse({tab:s.get("tab")||void 0});return t}const He="/assets/templates-1S_8WeSK.webp";function Ve(){return e.jsxs("div",{className:"layout-container space-y-5",children:[e.jsx(Ke,{}),e.jsx(Je,{})]})}function Ke(){return e.jsx(Se,{children:e.jsxs("div",{className:"flex w-full flex-wrap items-center gap-x-2 gap-y-0.5 text-text-md",children:[e.jsx("p",{className:"font-semibold",children:"This is a ZenML Pro feature. "}),e.jsx("p",{children:"Upgrade to ZenML Pro to access the Templates and save settings and run pipelines from the dashboard."})]})})}const Qe=["Run pipelines from the dashboard with Templates","Re-run a pipeline easily from the UI","Model and Artifact Control Plane Dashboard","Managed ZenML server on your VPC or hosted on our servers","Social SSO, RBAC, and User Management","CI/CD/CT, and more!"];function Je(){return e.jsxs(se,{className:"relative overflow-hidden px-7 py-5",children:[e.jsxs("div",{className:"max-w-[450px] space-y-4",children:[e.jsx("h2",{className:"text-display-xs font-semibold",children:"Access Advanced Template Features with ZenML Pro"}),e.jsx("ul",{className:"space-y-2",children:Qe.map((s,t)=>e.jsx("li",{className:"text-text-md text-theme-text-secondary",children:s},t))}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(x,{size:"md",asChild:!0,children:e.jsx("a",{href:"https://cloud.zenml.io/signup",target:"_blank",rel:"noopener noreferrer",children:"Upgrade to ZenML Pro"})}),e.jsx(x,{emphasis:"minimal",size:"md",children:e.jsx("a",{href:"https://www.zenml.io/pro",target:"_blank",rel:"noopener noreferrer",children:"Learn more"})})]})]}),e.jsx("img",{className:"absolute right-0 top-0 hidden translate-x-[30%] scale-75 md:translate-y-[30%] lg:block xl:-translate-y-[5%]",src:He,alt:"Screenshot of Zenml Pro Templates Feature"})]})}const We=[{value:"pipelines",label:"Pipelines",icon:Te},{value:"runs",label:"Runs",icon:w},{value:"templates",label:"Templates",icon:ie}];function Xe(){const[s]=b(),t=Ge(),a=ce();l.useEffect(()=>{if(!s.get("tab")){const i=new URLSearchParams(s);i.set("tab","pipelines"),a(`?${i.toString()}`,{replace:!0})}},[a,s]);function n(r){const i=new URLSearchParams;i.set("tab",r),a(`?${i.toString()}`)}return e.jsx("div",{className:"p-5",children:e.jsxs(te,{onValueChange:n,value:t,children:[e.jsx(ae,{children:We.map(r=>e.jsxs(ne,{className:"flex items-center gap-2 text-text-md",value:r.value.toLowerCase(),children:[e.jsx(r.icon,{className:`h-5 w-5 ${t===r.value?"fill-primary-400":"fill-theme-text-tertiary"}`}),r.label,r.value==="templates"&&e.jsx(re,{className:"rounded-sm font-semibold text-primary-500",color:"purple",size:"sm",children:"New"})]},r.value))}),e.jsx(v,{className:"m-0 mt-5 border-0 bg-transparent p-0",value:"pipelines",children:e.jsx(_e,{children:e.jsx(ze,{})})}),e.jsx(v,{className:"m-0 mt-5 border-0 bg-transparent p-0",value:"runs",children:e.jsx(Pe,{children:e.jsx(Ue,{})})}),e.jsx(v,{className:"m-0 mt-5 border-0 bg-transparent p-0",value:"templates",children:e.jsx(Ve,{})})]})})}function ys(){const{setCurrentBreadcrumbData:s}=le();return l.useEffect(()=>{s({segment:"pipelines",data:null})},[]),e.jsxs("div",{children:[e.jsx(oe,{children:e.jsx("h1",{className:"text-display-xs font-semibold",children:"Pipelines"})}),e.jsx(Xe,{})]})}export{ys as default};
